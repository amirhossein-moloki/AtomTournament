# جریان منطقی ادمین

این سند مسئولیت‌ها و گردش کار یک مدیر سیستم (ادمین) را تشریح می‌کند. ادمین‌ها بالاترین سطح دسترسی را دارند و مسئول سلامت کلی، پیکربندی و یکپارچگی پلتفرم هستند.

## ۱. نقش و دسترسی

-   یک ادمین معمولاً یک `superuser` یا عضوی از یک گروه ویژه "Admin" با دسترسی‌های گسترده در سراسر اپلیکیشن است.
-   رابط کاربری اصلی آن‌ها معمولاً پنل ادمین جنگو است، اگرچه ممکن است یک داشبورد فرانت‌اند سفارشی نیز برای عملیات‌های ساده‌تر در دسترس باشد.

## ۲. پیکربندی در سطح سیستم

ادمین‌ها مسئول راه‌اندازی و نگهداری داده‌های بنیادی هستند که پلتفرم بر اساس آن‌ها کار می‌کند.

1.  **مدیریت بازی‌ها:**
    *   ایجاد رکوردهای جدید `Game` و تعریف بازی‌هایی که می‌توان برای آن‌ها تورنومنت ایجاد کرد.
    *   بارگذاری تصاویر مرتبط با بازی‌ها (`GameImage`)، مانند بنرها، آیکون‌ها و تصاویر کوچک.
2.  **مدیریت رتبه‌ها (Ranks):**
    *   تعریف سطوح `Rank` برای پلتفرم (مانند برنزی، نقره‌ای، طلایی).
    *   تنظیم `required_score` (امتیاز مورد نیاز) برای دستیابی به هر رتبه.
    *   بارگذاری تصویر/آیکون مرتبط با هر رتبه.
3.  **مدیریت نقش‌ها و دسترسی‌ها:**
    *   اختصاص کاربران به نقش‌های (`Group`های) خاص مانند "Tournament Manager" یا "Support".
    *   ایجاد تخصیص‌های `GameManager`، که یک کاربر را به یک بازی پیوند می‌دهد تا به او مجوزهای مدیریتی بدهد.
4.  **تنظیمات پلتفرم:**
    *   تغییر پارامترهای عملیاتی در سطح سایت (مثلاً تنظیم محدودیت‌های ثابت مانند تعداد تیم‌هایی که یک کاربر می‌تواند به آن‌ها بپیوندد، که نیاز به تغییر کد دارد اما از نظر مفهومی یک وظیفه ادمین است).

## ۳. مدیریت کاربران و حساب‌ها

ادمین‌ها کنترل کاملی بر تمام حساب‌های کاربری دارند.

1.  **مشاهده و مدیریت کاربران:**
    *   دسترسی به لیستی از تمام `User`های ثبت‌شده.
    *   مشاهده و ویرایش اطلاعات پروفایل هر کاربر.
    *   معلق کردن، مسدود کردن یا حذف دستی حساب‌های کاربری.
2.  **نظارت مالی:**
    *   مشاهده `Wallet` (کیف پول) هر کاربر، شامل موجودی‌ها و تاریخچه کامل `Transaction`های آن‌ها.
    *   تنظیم دستی موجودی کیف پول کاربر در صورت لزوم (مثلاً برای صدور بازپرداخت یا پاداش)، اگرچه این کار باید با دقت بسیار انجام شود و همیشه با یک رکورد تراکنش همراه باشد.
3.  **تأیید هویت (Verification):**
    *   بررسی مدارک ارسالی کاربران برای تأیید هویت.
    *   تأیید یا رد دستی درخواست‌های تأیید هویت و تنظیم `verification_level` کاربر.
4.  **امنیت:**
    *   بازنشانی رمز عبور کاربران یا اجبار به تغییر رمز عبور.
    *   بررسی لاگ‌های ابزارهای امنیتی مانند `django-axes` برای شناسایی و مسدود کردن عوامل مخرب.

## ۴. نظارت سطح بالا بر تورنومنت‌ها و مسابقات

در حالی که مدیران تورنومنت‌ها عملیات روزمره را مدیریت می‌کنند، ادمین‌ها اختیار نهایی را دارند.

1.  **نمای کلی تورنومنت‌ها:** ادمین‌ها می‌توانند *تمام* تورنومنت‌های روی پلتفرم را، صرف نظر از اینکه چه کسی آن‌ها را ایجاد کرده، مشاهده و مدیریت کنند.
2.  **رسیدگی به موارد ارجاعی (Escalations):**
    *   اگر یک مدیر تورنومنت نتواند یک اختلاف `Match` یا `Report` پیچیده را حل کند، می‌تواند آن را به یک ادمین ارجاع دهد.
    *   ادمین تصمیم نهایی و قطعی را می‌گیرد.
3.  **مداخله اضطراری:** یک ادمین می‌تواند در شرایط اضطراری یک تورنومنت در حال برگزاری را متوقف، لغو یا اصلاح کند.
4.  **پرداخت‌های دستی:** اگر پرداخت خودکار جایزه با شکست مواجه شود، یک ادمین می‌تواند مشکل را بررسی کرده و پرداخت را به صورت دستی آغاز کند.

## ۵. پشتیبانی و سلامت سیستم

1.  **مدیریت تیکت‌ها:** ادمین‌ها می‌توانند تمام `support.Ticket`ها را مشاهده کنند، آن‌ها را بین ایجنت‌ها جابجا کنند و خودشان به مهم‌ترین یا ارجاعی‌ترین مسائل پشتیبانی رسیدگی کنند.
2.  **نظارت بر وظایف سیستمی:** آن‌ها می‌توانند به ابزارهای نظارت Celery (مانند Flower، در صورت یکپارچه‌سازی) دسترسی داشته باشند تا وضعیت وظایف پس‌زمینه مانند ارسال نوتیفیکیشن‌ها یا پردازش پرداخت‌ها را بررسی کرده و هرگونه شکست را رفع کنند.
