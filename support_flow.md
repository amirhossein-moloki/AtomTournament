# جریان منطقی ایجنت پشتیبانی

این سند گردش کار یک ایجنت پشتیبانی را توصیف می‌کند؛ کاربری که مسئول رسیدگی به سوالات کاربران، حل مشکلات و کمک به مدیریت پلتفرم است.

## ۱. نقش و دسترسی‌ها

-   یک ایجنت پشتیبانی کاربری است که به نقش یا گروه "Support" اختصاص داده شده است.
-   دسترسی‌های او بر روی ارتباطات، تحقیق و حل مسائل رو در روی کاربر متمرکز است.
-   فضای کاری اصلی او یک داشبورد پشتیبانی یا صف تیکت است.

## ۲. مسئولیت اصلی: مدیریت تیکت‌ها

وظیفه اصلی یک ایجنت پشتیبانی، مدیریت و حل تیکت‌های پشتیبانی است. مدل‌های `SupportTicket` و `SupportAssignment` در مرکز این گردش کار قرار دارند.

1.  **صف تیکت:**
    *   هنگامی که یک کاربر یک درخواست پشتیبانی از طریق پلتفرم ارسال می‌کند، یک `SupportTicket` جدید با وضعیت "Open" (باز) ایجاد می‌شود.
    *   ایجنت صفی از تیکت‌های باز و تخصیص‌داده‌نشده را مشاهده می‌کند.
2.  **تخصیص تیکت:**
    *   سیستم ممکن است به طور خودکار تیکت‌ها را به صورت نوبتی بین ایجنت‌ها تخصیص دهد.
    *   به طور جایگزین، یک ایجنت می‌تواند به صورت دستی یک تیکت را از صف تخصیص‌داده‌نشده بردارد، که یک رکورد `SupportAssignment` ایجاد کرده و او را به آن تیکت پیوند می‌دهد.
3.  **تحقیق و ارتباط:**
    *   ایجنت تیکت را باز می‌کند تا درخواست کاربر را بخواند.
    *   او از `chat.Conversation` یکپارچه‌شده با تیکت برای برقراری ارتباط با کاربر، درخواست اطلاعات بیشتر و ارائه به‌روزرسانی‌ها استفاده می‌کند.
    *   او از دسترسی‌های خود برای تحقیق در مورد مسئله استفاده می‌کند. این ممکن است شامل موارد زیر باشد:
        *   مشاهده پروفایل و فعالیت کاربر.
        *   بررسی تاریخچه `Transaction` در `Wallet` او.
        *   جستجوی جزئیات یک `Match` یا `Tournament`.
4.  **حل و فصل:**
    *   **حل مستقیم:** اگر ایجنت بتواند مشکل را مستقیماً حل کند (مثلاً با توضیح یک ویژگی یا شفاف‌سازی یک قانون)، پاسخ را به کاربر ارائه داده و تیکت را می‌بندد و وضعیت آن را به `resolved` (حل‌شده) تغییر می‌دهد.
    *   **ارجاع (Escalation):** اگر مسئله برای حل شدن نیاز به اختیارات بالاتری داشته باشد (مانند یک باگ در سیستم پرداخت، درخواست بازپرداخت دستی، یک مورد آزار و اذیت شدید)، ایجنت نمی‌تواند آن را خودش حل کند. او تیکت را با تخصیص مجدد آن یا علامت‌گذاری برای بررسی ادمین، به یک ادمین ارجاع می‌دهد.

## ۳. کمک به مدیریت تورنومنت

ایجنت‌های پشتیبانی اغلب به عنوان خط اول دفاع در مدیریت مسابقات عمل می‌کنند، به ویژه برای تورنومنت‌هایی که مدیر فعال و اختصاصی ندارند.

1.  **بررسی اختلافات مسابقه (Disputes):**
    *   یک ایجنت پشتیبانی می‌تواند از مسابقات مورد اختلاف مطلع شود.
    *   او همان فرآیند یک مدیر تورنومنت را دنبال می‌کند: بررسی مدارک (`result_proof`)، برقراری ارتباط با هر دو بازیکن و صدور حکم برای تعیین برنده صحیح.
2.  **رسیدگی به گزارش‌های کاربران (Reports):**
    *   ایجنت همچنین `Report`های دریافتی مربوط به تقلب یا رفتار ناشایست را اولویت‌بندی می‌کند.
    *   او ادعاها و مدارک را بررسی می‌کند.
    *   برای تخلفات جزئی، ممکن است یک هشدار صادر کند.
    *   برای جرائم جدی و تأیید شده، او گزارش را برای اقدام انضباطی مانند تعلیق حساب، به یک ادمین ارجاع می‌دهد.

## ۴. سناریوهای رایج پشتیبانی

-   **"پرداخت من ناموفق بود اما پول از حسابم کسر شد."** ایجنت لاگ `Transaction` و وضعیت درگاه پرداخت را بررسی می‌کند. اگر مشکل شناخته‌شده باشد، به کاربر اطلاع می‌دهد. اگر یک مشکل منحصر به فرد باشد، آن را به یک ادمین ارجاع می‌دهد.
-   **"چگونه به یک تیم بپیوندم؟"** ایجنت یک توضیح گام به گام از فرآیند دعوت به تیم ارائه می‌دهد.
-   **"بازیکن دیگر تقلب می‌کند."** ایجنت درخواست مدرک می‌کند، `Report` را بررسی می‌کند و ممکن است قبل از ارجاع، کلیپ‌های ویدئویی یا اسکرین‌شات درخواست کند.
-   **"نمی‌توانم در یک تورنومنت ثبت‌نام کنم."** ایجنت `Rank` و `verification_level` کاربر را با الزامات تورنومنت مقایسه کرده و دلیل آن را به کاربر اطلاع می‌دهد.
