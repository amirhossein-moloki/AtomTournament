
# مستندات سیستم نویسنده و احراز هویت

این سند، سیستم نویسندگی و احراز هویت در پروژه را توضیح می‌دهد.

## ۱. تفاوت کاربر و نویسنده

*   **کاربر (`User`)**: هر شخصی که در سایت ثبت‌نام می‌کند، یک آبجکت `User` برای او ساخته می‌شود. این کاربر می‌تواند وارد سایت شود، پروفایل و کیف پول داشته باشد و کارهای عمومی را انجام دهد. این مدل در فایل `users/models.py` تعریف شده است.
*   **نویسنده (`AuthorProfile`)**: نویسنده، کاربری است که یک "پروفایل نویسندگی" برای او ساخته شده باشد. این پروفایل اطلاعات اضافی مانند `display_name` (نام نمایشی) و `bio` (بیوگرافی) را نگهداری می‌کند. این مدل در `blog/models.py` قرار دارد و از طریق یک رابطه‌ی یک-به-یک (`OneToOneField`) به مدل `User` متصل است.

**نکته کلیدی**: یک کاربر برای اینکه بتواند پستی بنویسد، **حتماً** باید یک `AuthorProfile` داشته باشد.

## ۲. چگونه یک کاربر به نویسنده تبدیل می‌شود؟

بر اساس بررسی کد، فرآیند تبدیل شدن به نویسنده **خودکار نیست**. یعنی وقتی کاربری ثبت‌نام می‌کند، پروفایل نویسندگی برای او ساخته نمی‌شود. این کار باید به صورت دستی، به احتمال زیاد توسط یک **ادمین** از طریق پنل مدیریت جنگو، انجام شود. ادمین برای کاربری که می‌خواهد به او دسترسی نویسندگی بدهد، یک `AuthorProfile` ایجاد می‌کند.

## ۳. احراز هویت و دسترسی‌ها (Authentication & Permissions)

این بخش مشخص می‌کند که چه کسی به چه چیزی دسترسی دارد.

*   **چه کسی می‌تواند پست‌ها را ببیند؟**
    *   **همه**. هر کاربری، چه وارد سایت شده باشد و چه مهمان باشد، می‌تواند لیست پست‌ها را ببیند و متن کامل آن‌ها را بخواند (دسترسی فقط خواندنی یا `ReadOnly`).

*   **چه کسی می‌تواند پست جدید بنویسد؟**
    *   **فقط کاربرانی که `AuthorProfile` دارند**. مدل `Post` به `AuthorProfile` متصل است، بنابراین کاربری که این پروفایل را نداشته باشد اصلاً نمی‌تواند پستی ایجاد کند.

*   **چه کسی می‌تواند یک پست را ویرایش یا حذف کند؟**
    *   **نویسنده‌ی خود پست**: هر نویسنده فقط می‌تواند پستی را که **خودش** نوشته است ویرایش یا حذف کند.
    *   **کاربران ادمین (`is_staff=True`)**: ادمین‌ها به تمام پست‌ها دسترسی کامل دارند و می‌توانند هر پستی از هر نویسنده‌ای را ویرایش یا حذف کنند.

این منطق در فایل `blog/permissions.py` و به طور مشخص در کلاسی به نام `IsAuthorOrAdminOrReadOnly` پیاده‌سازی شده است.

## جدول خلاصه دسترسی‌ها

| عملیات | کاربر مهمان | کاربر عادی (بدون پروفایل نویسنده) | نویسنده | ادمین |
| :--- | :---: | :---: | :---: | :---: |
| **خواندن پست‌ها** | ✅ | ✅ | ✅ | ✅ |
| **نوشتن پست جدید** | ❌ | ❌ | ✅ | ✅ |
| **ویرایش/حذف پست خود** | ❌ | ❌ | ✅ | ✅ |
| **ویرایش/حذف پست دیگران**| ❌ | ❌ | ❌ | ✅ |
